function loadMarkers() {
  fetch("/lifesavers")
    .then(res => res.json())
    .then(data => {
      data.forEach(item => {
        if (item.lat && item.lng) {
          const marker = new naver.maps.Marker({
            position: new naver.maps.LatLng(item.lat, item.lng),
            map: map,
            title: item.name || "인명구조함",
            icon: {
              url: "/lifesaver-icon.png",
              size: new naver.maps.Size(40, 45),
              anchor: new naver.maps.Point(20, 45)
            }
          });

          markers.push(marker);

          naver.maps.Event.addListener(marker, 'click', function () {
            if (myLat === null || myLng === null) {
              alert('현재 위치를 가져올 수 없습니다.');
              return;
            }

            const nmapUrl = `nmap://route/car?slat=${myLat}&slng=${myLng}&dlat=${item.lat}&dlng=${item.lng}&appname=com.example.app`;

            const iwContent = `
              <div style="padding:6px; font-size:13px;">
                ${item.name || "인명구조함"}<br>
                <button onclick="window.location.href='${nmapUrl}'" style="margin-top:5px; background:none; border:none; color:blue; text-decoration:underline; cursor:pointer;">
                  길찾기 (네이버앱)
                </button>
              </div>
            `;

            infoWindow.setContent(iwContent);
            infoWindow.open(map, marker);
          });
        }
      });
    })
    .catch(err => {
      console.error("lifesavers.json 불러오기 오류:", err);
    });
}
